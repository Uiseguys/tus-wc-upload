/*! Built with http://stenciljs.com */
const{h:e}=window.App;class t{render(){return e("div",null,e("header",null,e("h1",null,"File Upload Library with Stencil Js")),e("main",{class:"row"},e("div",{class:"column"},e("cwc-file-chooser",{allowDrop:"true",allowClick:"true",allowMultiple:"true",serverAddress:"https://master.tus.io/files/"})),e("div",{class:"column"},e("cwc-upload-item",null)),e("div",{class:"UppyInput-Progress"})))}static get is(){return"app-root"}static get style(){return"/**style-placeholder:app-root:**/"}}class s{constructor(){this.allowDrop="true",this.allowClick="true",this.allowMultiple="true",this.accept=null,this.serverAddress="",this.file=[],this.error=[],this.currentFiles=[]}componentDidLoad(){this.uppy="true"==this.allowMultiple?Uppy.Core({debug:!0,autoProceed:!0,restrictions:{maxNumberOfFiles:null,allowedFileTypes:this.accept}}):Uppy.Core({debug:!0,autoProceed:!0,restrictions:{maxNumberOfFiles:1,allowedFileTypes:this.accept}}),this.initDragDropArea(),this.addedFiles(),this.uploadFiles(),this.progressBarHandler(),this.errorHandler(),this.uploadSuccess()}initDragDropArea(){if("true"==this.allowDrop&&"true"==this.allowClick)this.uppy.use(Uppy.DragDrop,{target:"#drag-drop-area",width:"100%",height:"100%",note:null,locale:{strings:{dropHereOr:("true"==this.allowMultiple?"Please drop files here or ":"Please drop file or ")+"%{browse}",browse:"select"}}});else if("true"==this.allowDrop&&"false"==this.allowClick){let s="true"==this.allowMultiple?"Please drop files":"Please drop file";this.uppy.use(Uppy.DragDrop,{target:"#drag-drop-area",width:"100%",height:"100%",note:null,locale:{strings:{dropHereOr:""}}});var e=document.createElement("h6"),t=document.createTextNode(s);e.classList.add("water-mark"),e.appendChild(t),document.getElementById("drag-drop-area").appendChild(e)}else"false"==this.allowDrop&&"true"==this.allowClick?this.error=[...this.error,"Under Development"]:(this.uppy.use(Uppy.DragDrop,{target:"#drag-drop-area",width:"100%",height:"100%",note:null,locale:{strings:{dropHereOr:"Please allow drop or allow Click"}}}),document.getElementById("drag-drop-area").style.pointerEvents="none")}addedFiles(){this.uppy.on("file-added",e=>{e.pause=!1,this.currentFiles=[...this.currentFiles,e],this.trackProgress()})}uploadFiles(){this.uppy.use(Uppy.Tus,{endpoint:this.serverAddress,resume:!0,autoRetry:!0,retryDelays:[0,1e3,3e3,5e3]})}uploadSuccess(){this.uppy.on("upload-success",(e,t)=>{let s=this.currentFiles.findIndex(t=>t.id==e.id);if(s>-1&&this.currentFiles.splice(s,1),"image/png"==t.file.type||"image/jpg"==t.file.type||"image/jpeg"==t.file.type||"image/svg"==t.file.type){var r=document.createElement("img");r.src=t.url,document.getElementById("image-list").appendChild(r)}})}progressBarHandler(){const e=Uppy.StatusBar;this.uppy.use(e,{target:".UppyInput-Progress",fixed:!0,hideAfterFinish:!1,hideUploadButton:!0})}errorHandler(){let e;this.uppy.on("info-visible",()=>{const t=this.uppy.getState().info;clearInterval(e),this.error=[...this.error,t.message]}),this.uppy.on("upload-error",t=>{clearInterval(e),this.error=[...this.error,t]}),e=setInterval(()=>{this.error=[]},3e3)}playPauseDownloading(e,t){this.currentFiles[t].pause=!this.currentFiles[t].pause,this.uppy.pauseResume(e.id)}trackProgress(){this.uppy.on("upload-progress",(e,t)=>{let s=this.currentFiles.findIndex(t=>t.id==e.id);s>-1&&(this.currentFiles[s].progress.percentage=100*t.bytesUploaded/t.bytesTotal,this.currentFiles[s].progress.bytesUploaded=t.bytesUploaded)})}render(){return[e("div",{class:"cwc-file-chooser"},e("div",{id:"drag-drop-area"}),this.currentFiles.map((t,s)=>e("div",{class:"progress-list"},e("div",{class:"file-name"},t.name),e("div",{class:"progress-footer"},e("button",{class:"play-pause-btn",onClick:()=>this.playPauseDownloading(t,s),innerHTML:1==t.pause?"<img src='https://png.icons8.com/metro/1600/play.png' >":"<img src='https://cdn3.iconfinder.com/data/icons/multimedia/100/pause-512.png'/>"}),e("span",null,1==t.pause?"Paused":"Uploading"," : ",Math.round(t.progress.percentage),"%")))),e("ul",null,this.error.map(t=>e("li",null,t))))]}static get is(){return"cwc-file-chooser"}static get properties(){return{accept:{type:"Any",attr:"accept"},allowClick:{type:"Any",attr:"allow-click"},allowDrop:{type:"Any",attr:"allow-drop"},allowMultiple:{type:"Any",attr:"allow-multiple"},currentFiles:{state:!0},error:{state:!0},file:{state:!0},serverAddress:{type:"Any",attr:"server-address"},uppy:{state:!0}}}static get style(){return"/**style-placeholder:cwc-file-chooser:**/"}}class r{constructor(){this.files=[],this.uppy=Uppy.Core({debug:!0,autoProceed:!0})}componentDidLoad(){const e=Uppy.FileInput;this.uppy.use(e,{target:".UppyForm",pretty:!0,inputName:"files[]",locale:{strings:{chooseFiles:"Choose Files"}}}),this.uppy.on("file-added",e=>{console.log("Added file",e)}),this.uppy.use(Uppy.Tus,{endpoint:"https://master.tus.io/files/"});const t=Uppy.StatusBar;this.uppy.use(t,{target:".UppyInput-Progress",fixed:!0,hideAfterFinish:!1,hideUploadButton:!0}),this.uppy.on("upload-success",(e,t)=>{console.log(e.name,t);var s=new Image;s.width=300,s.alt="",s.src=t,document.body.appendChild(s)})}render(){return e("div",{class:"cwc-upload-item"},e("h2",null,"Using the Input Tag "),e("div",{class:"UppyForm"}))}static get is(){return"cwc-upload-item"}static get properties(){return{files:{type:"Any",attr:"files"},uppy:{state:!0}}}static get style(){return"/**style-placeholder:cwc-upload-item:**/"}}export{t as AppRoot,s as CwcFileChooser,r as CwcUploadItem};