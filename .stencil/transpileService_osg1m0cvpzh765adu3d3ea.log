{"moduleFile":{"sourceFilePath":"/home/users/ajayveer/Music/stencil/my-app/src/components/file-uploader/file-uploader.tsx","localImports":[],"externalImports":["@stencil/core","@uppy/core","@uppy/dashboard","@uppy/tus","@uppy/xhr-upload","module","tus-js-client"],"potentialCmpRefs":[],"cmpMeta":{"tagNameMeta":"cwc-upload-item","stylesMeta":{"$":{"externalStyles":[{"absolutePath":"/home/users/ajayveer/Music/stencil/my-app/src/components/file-uploader/file-uploader.css","cmpRelativePath":"file-uploader.css","originalComponentPath":"file-uploader.css"}]}},"assetsDirsMeta":[],"hostMeta":{},"dependencies":[],"jsdoc":{"name":"AppProfile","documentation":"","type":"typeof AppProfile"},"encapsulationMeta":0,"componentClass":"AppProfile","membersMeta":{"uppy":{"memberType":16},"fileProvided":{"memberType":1,"attribName":"file-provided","attribType":{"text":"any[]","optional":false,"typeReferences":{}},"reflectToAttrib":false,"propType":0,"jsdoc":{"name":"fileProvided","documentation":"","type":"any[]"}}},"eventsMeta":[],"listenersMeta":[]},"hasSlot":false,"hasSvg":false,"jsFilePath":"/home/users/ajayveer/Music/stencil/my-app/src/components/file-uploader/file-uploader.js"},"jsText":"export class AppProfile {\r\n    constructor() {\r\n        this.fileProvided = [];\r\n        this.uppy = Uppy.Core({ debug: true, autoProceed: true });\r\n    }\r\n    // @Listen('fileProvided')\r\n    // onFileProvided(files) {\r\n    //   console.log(files)\r\n    // }\r\n    componentDidLoad() {\r\n        if (this.fileProvided)\r\n            console.log(this.fileProvided);\r\n    }\r\n    init(e) {\r\n        for (let i = 0; i < e.target.files.length; i++) {\r\n            var file = e.target.files[i];\r\n            file['pause'] = false;\r\n            file['uploaded'] = false;\r\n            file['progress'] = { bytesUploaded: 0, bytesTotal: file.size, percentage: \"0%\" };\r\n            file['nonUppy'] = true;\r\n            file['id'] = file.name;\r\n            this.currentFiles = [...this.currentFiles, file];\r\n            let self = this;\r\n            let upload = new tus.Upload(file, {\r\n                endpoint: this.serverAddress,\r\n                retryDelays: [0, 1000, 3000, 5000],\r\n                metadata: {\r\n                    filename: file.name,\r\n                    filetype: file.type\r\n                },\r\n                onError: function (error) {\r\n                    self.error = [...self.error, error.message];\r\n                    upload.start();\r\n                    console.log(\"Failed because: \" + error);\r\n                },\r\n                onProgress: function (bytesUploaded, bytesTotal) {\r\n                    var percentage = (Math.round((bytesUploaded * 100) / bytesTotal) + \"%\").toString();\r\n                    // console.log(file)\r\n                    let index = self.currentFiles.findIndex(x => x.id == file.id);\r\n                    if (index > -1) {\r\n                        self.currentFiles[index].progress.bytesUploaded = bytesUploaded;\r\n                        self.currentFiles[index].progress.percentage = percentage;\r\n                    }\r\n                },\r\n                onSuccess: function () {\r\n                    let index = self.currentFiles.findIndex(x => x.id == file.id);\r\n                    if (index > -1) {\r\n                        self.currentFiles[index].uploaded = true;\r\n                    }\r\n                }\r\n            });\r\n            // console.log(tus)\r\n            this.upload = [...this.upload, upload];\r\n            console.log(this.upload);\r\n            upload.start();\r\n            // Start the upload\r\n            // upload.abort()\r\n        }\r\n    }\r\n    render() {\r\n        var resumeButton = \"<img src='/assets/icon/play.png' >\";\r\n        var pauseButton = \"<img src='/assets/icon/pause-512.png'/>\";\r\n        var check = \"<img src='/assets/icon/checkmark-png-28.png' />\";\r\n        return (h(\"div\", { class: \"cwc-upload-item\" },\r\n            this.currentFiles.map((file, i) => h(\"div\", { class: \"progress-list\" },\r\n                h(\"div\", { class: \"file-name\" }, file.name),\r\n                h(\"div\", { id: \"myProgress\" },\r\n                    h(\"div\", { style: { width: file.progress.percentage } })),\r\n                file.uploaded ?\r\n                    h(\"div\", { class: \"progress-footer\" },\r\n                        h(\"button\", { class: \"play-pause-btn\", innerHTML: check }),\r\n                        h(\"span\", null, \"Complete\"))\r\n                    :\r\n                        h(\"div\", { class: \"progress-footer\" },\r\n                            h(\"button\", { class: \"play-pause-btn\", onClick: () => this.playPauseDownloading(file, i), innerHTML: file.pause == true ? resumeButton : pauseButton }),\r\n                            h(\"span\", null,\r\n                                \" \",\r\n                                file.pause == true ? \"Paused\" : \"Uploading\",\r\n                                \" : \",\r\n                                file.progress.percentage)))),\r\n            h(\"ul\", null, this.error.map((err) => h(\"li\", null, err))),\r\n            h(\"div\", { id: \"image-list\" })));\r\n    }\r\n    static get is() { return \"cwc-upload-item\"; }\r\n    static get properties() { return {\r\n        \"fileProvided\": {\r\n            \"type\": \"Any\",\r\n            \"attr\": \"file-provided\"\r\n        },\r\n        \"uppy\": {\r\n            \"state\": true\r\n        }\r\n    }; }\r\n    static get style() { return \"/**style-placeholder:cwc-upload-item:**/\"; }\r\n}\r\n"}