{"moduleFile":{"sourceFilePath":"/home/users/ajayveer/Music/stencil/my-app/src/components/file-uploader/file-uploader.tsx","localImports":[],"externalImports":["@stencil/core","@uppy/core","@uppy/dashboard","@uppy/tus","@uppy/xhr-upload","module","tus-js-client"],"potentialCmpRefs":[],"cmpMeta":{"tagNameMeta":"cwc-upload-item","stylesMeta":{"$":{"externalStyles":[{"absolutePath":"/home/users/ajayveer/Music/stencil/my-app/src/components/file-uploader/file-uploader.css","cmpRelativePath":"file-uploader.css","originalComponentPath":"file-uploader.css"}]}},"assetsDirsMeta":[],"hostMeta":{},"dependencies":[],"jsdoc":{"name":"AppProfile","documentation":"","type":"typeof AppProfile"},"encapsulationMeta":0,"componentClass":"AppProfile","membersMeta":{"refreshState":{"memberType":16},"filesList":{"memberType":16},"uploadsList":{"memberType":16},"error":{"memberType":16},"uploadobj":{"memberType":16},"fileProvided":{"memberType":1,"attribName":"file-provided","attribType":{"text":"any[]","optional":false,"typeReferences":{}},"reflectToAttrib":false,"propType":0,"jsdoc":{"name":"fileProvided","documentation":"","type":"any[]"},"watchCallbacks":["watchFiles"]},"endpoint":{"memberType":1,"attribName":"endpoint","attribType":{"text":"String","optional":false,"typeReferences":{"String":{"referenceLocation":"global"}}},"reflectToAttrib":false,"propType":0,"jsdoc":{"name":"endpoint","documentation":"","type":"String"}}},"eventsMeta":[],"listenersMeta":[]},"hasSlot":false,"hasSvg":false,"jsFilePath":"/home/users/ajayveer/Music/stencil/my-app/src/components/file-uploader/file-uploader.js"},"jsText":"export class AppProfile {\r\n    constructor() {\r\n        this.fileProvided = [];\r\n        this.endpoint = \"\";\r\n        this.refreshState = false;\r\n        this.filesList = [];\r\n        this.uploadsList = [];\r\n        this.error = [];\r\n        this.uploadobj = {};\r\n    }\r\n    watchFiles(newValue) {\r\n        this.init(newValue);\r\n    }\r\n    componentDidLoad() {\r\n    }\r\n    init(inputFiles) {\r\n        for (let i = 0; i < inputFiles.length; i++) {\r\n            var file = inputFiles[i];\r\n            file['pause'] = false;\r\n            file['uploaded'] = false;\r\n            file['progress'] = { bytesUploaded: 0, bytesTotal: file.size, percentage: \"0%\" };\r\n            file['id'] = Date.now() + file.size;\r\n            this.filesList = [...this.filesList, file];\r\n            let self = this;\r\n            let upload = new tus.Upload(file, {\r\n                endpoint: this.endpoint,\r\n                retryDelays: [0, 1000, 3000, 5000],\r\n                metadata: {\r\n                    filename: file.name,\r\n                    filetype: file.type\r\n                },\r\n                onError: function (error) {\r\n                    self.errorHandler(error, upload);\r\n                },\r\n                onProgress: function (bytesUploaded, bytesTotal) {\r\n                    var percentage = (Math.round((bytesUploaded * 100) / bytesTotal) + \"%\").toString();\r\n                    self.progressHandler(file, percentage);\r\n                },\r\n                onSuccess: function () {\r\n                    self.uploadSuccess(file);\r\n                }\r\n            });\r\n            this.uploadsList = [...this.uploadsList, upload];\r\n            upload.start();\r\n        }\r\n    }\r\n    progressHandler(file, percentage) {\r\n        var indexs = this.filesList.findIndex(x => x.name == file.name);\r\n        if (indexs > -1) {\r\n            this.filesList[indexs].progress.percentage = percentage;\r\n            this.refreshState = !this.refreshState;\r\n        }\r\n    }\r\n    uploadSuccess(file) {\r\n        let index = this.filesList.findIndex(x => x.id == file.id);\r\n        if (index > -1) {\r\n            this.filesList[index].uploaded = true;\r\n            this.refreshState = !this.refreshState;\r\n        }\r\n        // this.uppy.on('upload-success', (file, uploadURL) => {\r\n        //   console.log(file)\r\n        //   let index = this.files.findIndex(x => x.id == file.id);\r\n        //   if (index > -1) {\r\n        //     this.files[index].uploaded = true;\r\n        //   }\r\n        //   if (uploadURL.file.type == \"image/png\" ||\r\n        //     uploadURL.file.type == \"image/jpg\" ||\r\n        //     uploadURL.file.type == \"image/jpeg\" ||\r\n        //     uploadURL.file.type == \"image/svg\") {\r\n        //     var img = document.createElement(\"img\")\r\n        //     img.src = uploadURL.url;\r\n        //     let body = document.getElementById(\"image-list\")\r\n        //     body.appendChild(img)\r\n        //   }\r\n        // })\r\n    }\r\n    errorHandler(error, upload) {\r\n        this.refreshState = !this.refreshState;\r\n        this.error = [...this.error, error.message];\r\n        upload.start();\r\n        console.log(\"Failed because: \" + error);\r\n        // let timer;\r\n        // this.uppy.on('info-visible', () => {\r\n        //   const info = this.uppy.getState().info;\r\n        //   clearInterval(timer)\r\n        //   this.error = [...this.error, info.message]\r\n        // })\r\n        // this.uppy.on('upload-error', (error) => {\r\n        //   clearInterval(timer)\r\n        //   this.error = [...this.error, error]\r\n        // })\r\n        // timer = setInterval(() => {\r\n        //   this.error = [];\r\n        // }, 3000)\r\n    }\r\n    playPauseDownloading(file, i) {\r\n        if (file) { }\r\n        this.filesList[i].pause = !this.filesList[i].pause;\r\n        if (this.filesList[i].pause == true) {\r\n            this.uploadsList[i].abort();\r\n        }\r\n        else {\r\n            this.uploadsList[i].start();\r\n        }\r\n    }\r\n    render() {\r\n        var resumeButton = \"<img src='/assets/icon/play-button.svg' >\";\r\n        // var pauseButton = \"<img src='/assets/icon/pause-512.png'/>\";\r\n        // var check = \"<img src='/assets/icon/checkmark-png-28.png' />\";\r\n        return (\r\n        // <div class=\"cwc-upload-item\">\r\n        //   <h4>Uploader</h4>\r\n        //   {/* Uploading File List */}\r\n        //   {this.filesList.map((file, i) =>\r\n        //     <div class=\"progress-list\">\r\n        //       <div class=\"file-name\">{file.name}</div>\r\n        //       {/* Progress Bar */}\r\n        //       <div id=\"myProgress\">\r\n        //         <div style={{ width: (file.progress.percentage) }}></div>\r\n        //       </div>\r\n        //       {file.uploaded ?\r\n        //         <div class=\"progress-footer\">\r\n        //           <button class=\"play-pause-btn\"\r\n        //             innerHTML={check}>\r\n        //           </button>\r\n        //           <span>Complete</span>\r\n        //         </div>\r\n        //         :\r\n        //         <div class=\"progress-footer\">\r\n        //           <button class=\"play-pause-btn\"\r\n        //             onClick={() => this.playPauseDownloading(file, i)}\r\n        //             innerHTML={file.pause == true ? resumeButton : pauseButton}>\r\n        //           </button>\r\n        //           <span> {file.pause == true ? \"Paused\" : \"Uploading\"} : {file.progress.percentage}</span>\r\n        //         </div>\r\n        //       }\r\n        //     </div >\r\n        //   )}\r\n        //   {/* Errors */}\r\n        //   <ul>\r\n        //     {this.error.map((err) =>\r\n        //       <li>{err}</li>\r\n        //     )}\r\n        //   </ul>\r\n        //   <div id=\"image-list\"></div>\r\n        // </div>\r\n        h(\"div\", { class: \"st_container\" },\r\n            h(\"div\", { class: \"st_content_align_center\" },\r\n                h(\"div\", { class: \"st_uploaded_file st_w_100 st_text-center\" },\r\n                    h(\"div\", { class: \"uploaded_images\" },\r\n                        h(\"div\", { class: \"st_row\" },\r\n                            h(\"div\", { class: \"st_wid_20\" },\r\n                                h(\"div\", { class: \"st_image\" },\r\n                                    h(\"img\", { src: \"http://ishort.co/wp-content/uploads/free-images-of-nature-nature-images-pixabay-download-free-pictures.jpg\", class: \"st_wid_100\" })),\r\n                                h(\"div\", { class: \"st_barVDOcancel st_w_100\" },\r\n                                    h(\"div\", { class: \"st_row st_bg\" },\r\n                                        h(\"div\", { class: \"st_wid_70\" },\r\n                                            h(\"div\", { class: \"st_progress-bar\" },\r\n                                                h(\"div\", { class: \"st_loaded\", style: { width: \"2%\" } }))),\r\n                                        h(\"div\", { class: \"st_wid_15\" },\r\n                                            h(\"a\", { id: \"play-video\", class: \"video-play-button\", href: \"#\" }, resumeButton)),\r\n                                        h(\"div\", { class: \"st_wid_15\" },\r\n                                            h(\"a\", { class: \"st_closeBtn\", href: \"#\" },\r\n                                                h(\"img\", { style: { width: \"20px\" }, src: \"/assets/icon/cancel.svg\" }))))))))))));\r\n    }\r\n    static get is() { return \"cwc-upload-item\"; }\r\n    static get properties() { return {\r\n        \"endpoint\": {\r\n            \"type\": \"Any\",\r\n            \"attr\": \"endpoint\"\r\n        },\r\n        \"error\": {\r\n            \"state\": true\r\n        },\r\n        \"fileProvided\": {\r\n            \"type\": \"Any\",\r\n            \"attr\": \"file-provided\",\r\n            \"watchCallbacks\": [\"watchFiles\"]\r\n        },\r\n        \"filesList\": {\r\n            \"state\": true\r\n        },\r\n        \"refreshState\": {\r\n            \"state\": true\r\n        },\r\n        \"uploadobj\": {\r\n            \"state\": true\r\n        },\r\n        \"uploadsList\": {\r\n            \"state\": true\r\n        }\r\n    }; }\r\n    static get style() { return \"/**style-placeholder:cwc-upload-item:**/\"; }\r\n}\r\n"}